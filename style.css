body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
    color: #333;
    line-height: 1.6;
}

header {
    background: #333;
    color: #fff;
    padding: 1rem 0;
    text-align: center;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-around;
    align-items: center;
}

header h1 {
    margin: 0;
    font-size: 1.8rem;
}

#downloadLogBtn {
    padding: 0.5rem 1rem;
    background-color: #555;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
#downloadLogBtn:hover {
    background-color: #777;
}

.container {
    width: 90%;
    max-width: 1500px;
    margin: auto;
    overflow: hidden;
    padding: 0 20px;
}

.setup, .game-area, #timeline {
    background: #fff;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

h2, h3 {
    color: #333;
    text-align: center;
    margin-bottom: 15px;
}

.player-options button, #confirmCharactersButton, #startButton,
#confirmMarket, #nextRoundBtn, #backToMarketSelectionBtn, #resetMarketSelectionBtn,
.action-buttons button, .manual-controls button {
    display: inline-block;
    background: #5cb85c;
    color: #fff;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin: 5px;
    font-size: 1em;
    transition: background-color 0.3s ease;
    vertical-align: middle; /* Align buttons nicely */
}

.player-options button:hover, #confirmCharactersButton:hover, #startButton:hover,
#confirmMarket:hover, #nextRoundBtn:hover, #backToMarketSelectionBtn:hover, #resetMarketSelectionBtn:hover,
.action-buttons button:hover, .manual-controls button:hover {
    background: #4cae4c;
}

.player-options button.selected, #confirmCharactersButton.selected {
    background: #4cae4c;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
}
#marketArea {
    display: flex;
    flex-wrap: wrap; /* 允許換行 */
    justify-content: center; /* 居中對齊 */
    gap: 10px;
    padding: 10px;
    border: 1px dashed #ccc;
    min-height: 50px;
}
#marketArea button {
    background-color: #f0ad4e; /* 橘黃色 */
    color: #fff;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
}
#marketArea button:hover {
    background-color: #ec971f;
}
#marketArea button.selected {
    background-color: #d58512; /* 深橘色 */
    box-shadow: inset 0 0 8px rgba(0,0,0,0.4);
    transform: scale(0.95); /* 輕微縮小以提供視覺反饋 */
}
button:disabled {
    background: #ccc !important;
    cursor: not-allowed !important;
}

.error-message {
    color: red;
    text-align: center;
    margin: 10px 0;
    font-weight: bold;
}

#characterSelectionUI, #marketSelection, #playerActions {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid #eee;
}

.character-selector-wrapper {
    margin-bottom: 10px;
    text-align: center;
}
.character-selector-wrapper label {
    margin-right: 10px;
}
.character-selector-wrapper select {
    padding: 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
    min-width: 250px;
}


.card-selection-area {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 15px;
    padding: 10px;
    border: 1px dashed #ccc;
    min-height: 50px;
}
.card-selection-area button, .action-buttons button {
    background-color: #f0ad4e; /* Market/action card color */
    min-width: 120px;
    white-space: normal; /* Allow button text to wrap */
    height: auto; /* Adjust height based on content */
    padding: 8px;
    text-align: center;
    line-height: 1.3;
}
.card-selection-area button:hover, .action-buttons button:hover {
    background-color: #ec971f;
}
.card-selection-area button.selected, .action-buttons button.selected {
    background-color: #d58512;
    color: white;
    box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
}
.market-status-text {
    width: 100%;
    text-align: center;
    color: #777;
    font-style: italic;
}


.player-action-zones {
    display: flex;
    justify-content: flex-start;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 20px;
}
.player-zone {
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    background-color: #f9f9f9;
    flex-basis: 30%; /* Adjust for 3 players */
    min-width: 280px; /* Ensure readability */
    display: flex;             /* 將此區塊也設為 Flex 容器 */
    flex-direction: column;    /* 設定主軸方向為「垂直」 */
    align-items: stretch;      /* 讓內部元素在交叉軸(水平)上撐滿寬度 */
    gap: 15px;   
}
.player-zone h3 {
    margin-top: 0;
    font-size: 1.2rem;
}
.action-buttons {
    display: flex;
    flex-direction: column; /* Stack buttons vertically */
    gap: 8px;
    align-items: stretch; /* Make buttons full width of container */
}
.action-buttons button {
    width: 100%; /* Buttons take full width of their parent */
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
}
.skill-choice-hint {
    font-size: 0.9em;
    color: #555;
    width: 100%;
    text-align: center;
    margin-bottom: 10px;
    background-color: #eef;
    padding: 5px;
    border-radius: 3px;
}


.time-bar-container {
    width: 100%;
    background-color: #e0e0e0;
    height: 25px;
    border-radius: 5px;
    margin-bottom: 10px;
    height: 25px; /* Match EVENT_SEGMENT_HEIGHT */
    position: relative;
    overflow: hidden; /* Ensure inner bar doesn't overflow on 100% */
}
.bar-inner {
    height: 100%;
    color: white;
    text-align: center;
    line-height: 25px;
    border-radius: 5px 0 0 5px; /* Rounded only on left if not full */
    transition: width 0.5s ease-in-out, background-color 0.5s ease;
    font-weight: bold;
    font-size: 0.9em;
    position: absolute; /* For precise positioning if needed */
    left: 0;
    top: 0;
}
.bar-inner.safe { background-color: #4caf50; } /* Green */
.bar-inner.warning { background-color: #ff9800; } /* Orange */
.bar-inner.danger { background-color: #d32f2f; } /* Red */
.bar-inner.empty { background-color: #424242; border-radius: 5px; } /* Grey, full radius if empty */


#timeline {
    margin-top: 30px;
}
.timeline-player-zone {
    margin-bottom: 20px;
}
.timeline-track {
    background-color: #e9e9e9;
    padding: 10px;
    border-radius: 5px;
    overflow-x: auto; /* Allow horizontal scrolling for long timelines */
    white-space: nowrap; /* Keep events in a single line */
}
.events-container {
    display: flex; /* Align events horizontally */
    align-items: center; /* Vertically align items in the center */
    min-height: 160px; /* Ensure container has height even if empty */
    padding-left: 50px;
}
.event {
    height: 25px; /* EVENT_SEGMENT_HEIGHT */
    border: 1px solid #aaa;
    background-color: #ccc;
    margin-right: 2px;
    padding: 0 5px;
    box-sizing: border-box;
    text-align: center;
    line-height: 23px; /* Adjust for border */
    font-size: 0.8em;
    font-weight: bold;
    cursor: pointer;
    position: relative; /* For tooltip positioning */
    display: inline-flex; /* Use flex for centering content */
    align-items: center;
    justify-content: center;
    border-radius: 3px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.event:hover {
    transform: scale(1.1);
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    z-index: 1000 !important; /* Ensure hovered event is on top */
}
.event.enlarged { /* For clicked event, might not be needed if hover is enough */
    transform: scale(1.2);
    z-index: var(--top-z-index, 100); /* Use CSS variable if set by JS, else default */
}
.event .tooltip {
    visibility: hidden;
    width: max-content; /* Adjust width to content */
    max-width: 300px; /* Max width for readability */
    background-color: #222;
    color: #fff;
    text-align: left;
    border-radius: 5px;
    padding: 8px 10px;
    position: absolute;
    z-index: 30;
    white-space: nowrap; /* 禁止換行 */
    width: max-content; /* 自動延展，符合內容長度 */
    max-width: none; /* 不設最大寬度限制 */
    box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.25);
    opacity: 0;
    transition: opacity 0.2s ease, visibility 0s 0.2s;
}
.tooltip-top {
    bottom: calc(100% + 5px);
    right: auto;
    left: 0;
}
.tooltip-bottom {
    top: calc(100% + 5px);
    right: auto;
    left: 0;
}
.event:hover .tooltip {
    visibility: visible;
    opacity: 1;
}
.event.enlarged {
    transform: scale(1.5); 
    z-index: 15; 
}
.event.enlarged .tooltip { 
    visibility: visible;
    opacity: 1;
}
.tooltip-top::after, .tooltip-bottom::after { /* Arrow */
    content: "";
    position: absolute;
    left: 15px;
    transform: translateX(-50%);
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
}
.tooltip-top::after { top: 100%; border-color: #222 transparent transparent transparent; }
.tooltip-bottom::after { bottom: 100%; border-color: transparent transparent #222 transparent; }

/* Event type specific styles */
.event.buy { background-color: #90caf9; border-color: #64b5f6; } /* Light Blue */
.event.buy_fail { background-color: #ef9a9a; border-color: #e57373; color: #c62828; } /* Light Red */
.event.rest { background-color: #a5d6a7; border-color: #81c784; } /* Light Green */
.event.bidding.win, .event.bidding.win_skill { background-color: #fff59d; border-color: #fff176; color: #555; } /* Light Yellow */
.event.bidding.lose, .event.bidding.lose_tie_skill { background-color: #ffcc80; border-color: #ffb74d; } /* Light Orange */
.event.bidding.pass, .event.bidding.pass_all { background-color: #e0e0e0; border-color: #bdbdbd; } /* Grey */
.event.bidding.tie_unresolved { background-color: #b39ddb; border-color: #9575cd; } /* Light Purple */
.event.draw_acquire { background-color: #80deea; border-color: #4dd0e1; } /* Light Cyan */
.event.draw_decline { background-color: #ffab91; border-color: #ff8a65; } /* Light Deep Orange */
.event.skill_effect { background-color: #ce93d8; border-color: #ba68c8; } /* Light Pink/Purple */
.event.manual_adjust { background-color: #bcaaa4; border-color: #a1887f; } /* Light Brown */
.event.phase_tick { background-color: #f5f5f5; border-color: #e0e0e0; width: 10px !important; min-width:10px !important; padding:0; }
.event.phase_tick.bid_win_marker { background-color: #ffe082; border-color: #ffd54f; }
.event.phase_info { background-color: #9e9e9e; color:white; border-color: #757575;}
.event.error_event { background-color: #d32f2f; color:white; border-color: #c62828;}


/* Bidding Window Styles */
.bidding-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 25px;
    border: 1px solid #ccc;
    box-shadow: 0px 0px 15px rgba(0,0,0,0.2);
    z-index: 2000; /* High z-index to be on top */
    border-radius: 8px;
    width: 80%;
    max-width: 500px;
    text-align: center;
}
.bidding-window h3 {
    margin-top: 0;
    color: #333;
}
.bidding-window p {
    margin: 10px 0;
    font-size: 1em;
}
.bidding-window button {
    background: #007bff;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 5px;
    min-width: 80px;
}
.bidding-window button:hover {
    background: #0056b3;
}
.bidding-window button:disabled {
    background: #ccc;
}
.consolation-choice-window .card-selection-area button,
.consolation-purchase-window .card-selection-area button {
    background-color: #f0ad4e; /* 橘黃色 */
    color: #fff;
    padding: 10px 12px; /* 稍微增加垂直內距，讓按鈕更大更易點擊 */
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
    display: block;
    margin: 8px auto; /* 保持原樣 */
    width: 95%;       /* 稍微調整寬度以適應 padding */
    text-align: center; /* 確保文字置中 */
}
.btn-card-choice {
    background-color: #f0ad4e; /* 卡片選擇按鈕的統一顏色 (橘黃色) */
    color: #fff;
    min-width: 120px;
    white-space: normal;
    height: auto;
    padding: 8px;
    text-align: center;
    line-height: 1.3;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin: 5px;
    font-size: 1em;
    transition: background-color 0.3s ease;
    vertical-align: middle;
}

.btn-card-choice:hover {
    background-color: #573c17;
}
.btn-card-choice.selected {
    background-color: #d58512;
    color: white;
    box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
}
.manual-controls {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 10px;
}
.manual-controls button {
    background-color: #6c757d; /* Grey for manual controls */
    padding: 5px 10px;
    font-size: 0.9em;
}
.manual-controls button:hover {
    background-color: #5a6268;
}
.consolation-choice-window button {
    background-color: #f0ad4e; /* 橘黃色 */
    color: #fff;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
    display: block;
    margin: 8px auto;
    width: 90%;
}

.scrollable-card-list {
    max-height: 300px;   /* 設定最大高度，例如 300px */
    overflow-y: auto;    /* 當內容超出最大高度時，顯示垂直滾動條 */
    
    /* 以下是建議的視覺樣式，讓列表區塊更清晰 */
    margin-bottom: 15px; /* 與下方的「放棄」按鈕間隔開 */
    padding: 10px;         /* 內部留白 */
    border: 1px solid #ccc; /* 加上邊框 */
    background-color: #f9f9f9; /* 淺灰色背景 */
    border-radius: 5px;      /* 圓角 */
}